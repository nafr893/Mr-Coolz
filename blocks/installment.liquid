{% if product.selected_or_first_available_variant.selling_plan_allocations.size > 0 %}
  {% assign installment = product.selected_or_first_available_variant.selling_plan_allocations[0].selling_plan %}
  <div class="installments text-{{ block.settings.alignment }}">
    <span class="installments__text">
      or {{ installment.options[0].value }} payments of
      {{ product.selected_or_first_available_variant.price | divided_by: installment.options[0].value | money }}
    </span>
  </div>
{% elsif shop.installments_enabled and product.selected_or_first_available_variant.price > 0 %}
  {% assign count = block.settings.installment_count | default: 4 %}
  <div class="installments text-{{ block.settings.alignment }}">
    <span class="installments__text">
      or {{ count }} payments of
      {{ product.selected_or_first_available_variant.price | divided_by: count | money }}
    </span>
  </div>
{% endif %}

{% schema %}
{
  "name": "Installment Price",
  "target": "section",
  "settings": [
    {
      "type": "number",
      "id": "installment_count",
      "label": "Number of installments (fallback)",
      "default": 4,
      "min": 1
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "Text alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    }
  ]
}
{% endschema %}